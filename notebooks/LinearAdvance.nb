Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["t", "a"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["t", "c"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["t", "d"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["t", "tot"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["v", "s"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["v", "e"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["v", "max"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["v", "c"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["a", "max"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox[
     SubscriptBox["reach", "v"], "max"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["\[CapitalDelta]v", "max"]},
   "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CleanNotebook", "[", "nb_NotebookObject", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"SetOptions", "[", 
      RowBox[{"nb", ",", 
       RowBox[{"PrivateNotebookOptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "False"}], "}"}]}], 
       ",", 
       RowBox[{"\"\<TrackCellChangeTimes\>\"", "\[Rule]", "False"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"SetSelectedNotebook", "[", "nb", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{"nb", ",", "All", ",", "Notebook"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FrontEndExecute", "[", 
      RowBox[{"{", 
       RowBox[{"FrontEnd`RemoveOptions", "[", 
        RowBox[{"FrontEnd`SelectionObject", ",", "\"\<CellChangeTimes\>\""}], 
        "]"}], "}"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "Code",
 CellLabel->"In[3]:=",ExpressionUUID->"b1a5ad45-9f5b-487c-8a84-be30af13977d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseIntegrate", "[", 
   RowBox[{"piecewise_Piecewise", ",", " ", 
    RowBox[{"start_", " ", ":", " ", "0"}]}], "]"}], " ", ":=", " ", "\n", 
  "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t\t", 
     RowBox[{
     "getInterval", ",", "\n", "\t\t\t\t", "calculatePiece", ",", "\n", 
      "\t\t\t\t", "intervalStart", ",", "\n", "\t\t\t\t", "intervalEnd", ",", 
      "\n", "\t\t\t\t", "intervalIntegral", ",", "\n", "\t\t\t\t", "total", 
      ",", "\n", "\t\t\t\t", "pieces"}], "}"}], ",", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"getInterval", "[", 
       RowBox[{"f_", ",", " ", "x_"}], "]"}], " ", ":=", " ", "\n", 
      "\t\t\t\t", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Simplify", "@", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "x"}], "}"}], ",", "t"}], "]"}]}]}], "]"}], 
       "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"calculatePiece", "[", 
       RowBox[{"{", 
        RowBox[{"f_", ",", " ", "conditions_"}], "}"}], "]"}], " ", ":=", " ", 
      RowBox[{"(", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"intervalStart", " ", "=", " ", 
         RowBox[{"getInterval", "[", 
          RowBox[{"Minimize", ",", " ", "conditions"}], "]"}]}], ";", "\n", 
        "\t\t\t\t", 
        RowBox[{"intervalEnd", " ", "=", " ", 
         RowBox[{"getInterval", "[", 
          RowBox[{"Maximize", ",", " ", "conditions"}], "]"}]}], ";", "\t", 
        "\n", "\t\t\t\t", 
        RowBox[{"intervalIntegral", " ", "=", " ", 
         RowBox[{"total", " ", "+", " ", 
          RowBox[{"Integrate", "[", 
           RowBox[{"f", ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "intervalStart", ",", " ", "t"}], "}"}]}],
            "]"}]}]}], ";", "\n", "\t\t\t\t", 
        RowBox[{"total", " ", "=", " ", 
         RowBox[{"intervalIntegral", " ", "/.", " ", 
          RowBox[{"t", " ", "\[Rule]", " ", "intervalEnd"}]}]}], ";", "\n", 
        "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Simplify", "@", "intervalIntegral"}], ",", " ", 
          "conditions"}], "}"}]}], "\n", "\t\t\t", ")"}]}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"total", " ", "=", " ", "start"}], ";", "\n", "\t\t\t", 
     RowBox[{"pieces", " ", "=", " ", 
      RowBox[{"calculatePiece", "/@", 
       RowBox[{"First", "[", "piecewise", "]"}]}]}], ";", "\n", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "the", " ", "last", " ", "interval", " ", "is", " ", 
        "bounded"}], ",", " ", 
       RowBox[{
       "we", " ", "need", " ", "to", " ", "add", " ", "an", " ", "additional",
         " ", "piece"}]}], "*)"}], "\n", "\t\t\t", 
     RowBox[{"Piecewise", "[", "\n", "\t\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"intervalEnd", " ", "===", " ", "\[Infinity]"}], ",", "\n", 
        "\t\t\t\t\t", "pieces", ",", "\n", "\t\t\t\t\t", 
        RowBox[{"Append", "[", 
         RowBox[{"pieces", ",", " ", 
          RowBox[{"{", 
           RowBox[{"total", ",", " ", 
            RowBox[{"t", " ", ">", " ", "intervalEnd"}]}], "}"}]}], "]"}]}], 
       "]"}], "]"}]}]}], "]"}]}]], "Code",
 CellLabel->"In[16]:=",ExpressionUUID->"f91edb74-1a25-4c1e-bbcd-644d0150e255"],

Cell[TextData[{
 "Hello there, with some formula\n",
 Cell[BoxData[
  DynamicBox[ToBoxes[
    TraditionalForm[
     $CellContext`printSubscripts[
      Simplify[
       ReplaceAll[$CellContext`a, $CellContext`trapezoidial]]]], StandardForm],
   ImageSizeCache->{225., {21., 28.}}]], "Output",ExpressionUUID->
  "e3895b6c-acbc-4c70-8658-6480c672ff9b"],
 "\nAnd some text after"
}], "Text",ExpressionUUID->"99a5bbee-9cfa-46bb-aa69-11367bfdda7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"a", ",", " ", "v", ",", " ", "x", ",", " ", 
    SubscriptBox["v", "c"], ",", " ", 
    SubscriptBox["t", "a"], ",", " ", 
    SubscriptBox["t", "c"], ",", " ", 
    SubscriptBox["t", "d"], ",", 
    SubscriptBox["t", "tot"]}], "]"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a", "max"], ",", " ", 
        RowBox[{"0", "\[LessEqual]", " ", "t", " ", "<=", " ", 
         SubscriptBox["t", "a"]}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{
         SubscriptBox["t", "a"], " ", "<", " ", "t", " ", "<=", " ", 
         RowBox[{
          SubscriptBox["t", "a"], " ", "+", " ", 
          SubscriptBox["t", "c"]}]}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["a", "max"]}], ",", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["t", "a"], " ", "+", " ", 
          SubscriptBox["t", "c"]}], " ", "<", " ", "t", " ", "\[LessEqual]", 
         " ", 
         RowBox[{
          SubscriptBox["t", "a"], " ", "+", " ", 
          SubscriptBox["t", "c"], " ", "+", " ", 
          SubscriptBox["t", "d"]}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
     "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"v", " ", "=", " ", 
  RowBox[{"PiecewiseIntegrate", "[", 
   RowBox[{"a", ",", " ", 
    SubscriptBox["v", "s"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"PiecewiseIntegrate", "[", "v", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["v", "c"], " ", "=", " ", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"d", " ", "*", " ", 
       SubscriptBox["a", "max"]}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["v", "s"], "2"], " ", "+", " ", 
         SuperscriptBox[
          SubscriptBox["v", "e"], "2"]}], ")"}], " ", "/", " ", "2"}]}], 
     "]"}], ",", " ", 
    SubscriptBox["v", "max"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", 
   RowBox[{"a", " "}]], "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["v", "c"], " ", "-", " ", 
     SubscriptBox["v", "s"]}], ")"}], " ", "/", " ", 
   SubscriptBox["a", "max"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", "d"], " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["v", 
      RowBox[{"c", " "}]], "-", " ", 
     SubscriptBox["v", "e"]}], ")"}], " ", "/", " ", 
   SubscriptBox["a", "max"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", "tot"], "=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["d", 
         SubscriptBox["v", "max"]], " ", "+", " ", 
        RowBox[{
         FractionBox[
          SubscriptBox["v", "max"], 
          RowBox[{"2", " ", 
           SubscriptBox["a", "max"]}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", " ", 
            FractionBox[
             SubscriptBox["v", "s"], 
             SubscriptBox["v", "max"]]}], ")"}], "2"]}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["v", "max"], 
          RowBox[{"2", " ", 
           SubscriptBox["a", "max"]}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", " ", 
            FractionBox[
             SubscriptBox["v", "e"], 
             SubscriptBox["v", "max"]]}], ")"}], "2"]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["v", "c"], " ", "==", " ", 
        SubscriptBox["v", "max"]}]}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["t", "a"], " ", "+", " ", 
     SubscriptBox["t", "d"]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["t", 
    RowBox[{"c", " "}]], "=", " ", 
   RowBox[{
    SubscriptBox["t", "tot"], " ", "-", " ", 
    SubscriptBox["t", 
     RowBox[{"a", " "}]], "-", 
    SubscriptBox["t", "d"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "max"], " ", "=", " ", "1000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["v", "s"], " ", "=", " ", "20"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["v", "e"], " ", "=", " ", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", "50"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["v", "max"], "=", " ", "100"}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"N", "@", 
      RowBox[{"Simplify", "[", "a", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"N", "@", 
      RowBox[{"Simplify", "[", "v", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"N", "@", 
      RowBox[{"Simplify", "[", "x", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "v", ",", " ", "x"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"a084958a-45ef-4431-b9de-7bb8337a84d1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["a", "max"], ",", " ", 
       RowBox[{"0", "\[LessEqual]", " ", "t", " ", "<=", " ", 
        SubscriptBox["t", "a"]}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"b", ",", " ", 
       RowBox[{
        SubscriptBox["t", "c"], ">", " ", 
        SubscriptBox["t", "a"], " ", "<", " ", "t", " ", "<=", " ", 
        RowBox[{
         SubscriptBox["t", "a"], " ", "+", " ", 
         SubscriptBox["t", "c"]}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["a", "max"]}], ",", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["t", "a"], " ", "+", " ", 
         SubscriptBox["t", "c"]}], " ", "<", " ", "t", " ", "\[LessEqual]", 
        " ", 
        RowBox[{
         SubscriptBox["t", "a"], " ", "+", " ", 
         SubscriptBox["t", "c"], " ", "+", " ", 
         SubscriptBox["t", "d"]}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["a", "max"], "=", " ", "1500"}], "\[IndentingNewLine]", 
 RowBox[{"b", " ", "=", " ", "1000"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", 
   RowBox[{"a", " "}]], "=", " ", 
  RowBox[{"p", " ", 
   RowBox[{"Log", "[", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["a", "max"], " ", "p"}], "-", 
      SubscriptBox["v", "s"]}], 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "max"], " ", "p"}], "-", 
      RowBox[{"b", " ", "p"}]}]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", "c"], " ", "=", " ", 
  FractionBox[
   RowBox[{"100", "-", 
    RowBox[{
     SubscriptBox["a", "max"], " ", 
     SubscriptBox["t", "a"]}], "+", 
    RowBox[{
     SubscriptBox["a", "max"], " ", "p", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{
        SubscriptBox["a", "max"], "+", "b"}], 
       SubscriptBox["a", "max"]], "]"}]}]}], "b"]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", "d"], " ", "=", " ", 
  RowBox[{"p", " ", 
   RowBox[{"Log", "[", 
    FractionBox[
     RowBox[{
      SubscriptBox["a", "max"], "+", "b"}], 
     SubscriptBox["a", "max"]], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["v", 
   RowBox[{"s", " "}]], "=", " ", "20"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", " ", "0.03"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["t", "a"], " ", "+", " ", 
  SubscriptBox["t", "c"], " ", "+", 
  SubscriptBox["t", "d"]}], "\[IndentingNewLine]", 
 RowBox[{"v", " ", "=", " ", 
  RowBox[{
   SubscriptBox["v", "s"], " ", "+", 
   RowBox[{"Integrate", "[", 
    RowBox[{"a", ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"Real", " ", "&&", " ", 
       RowBox[{"t", " ", "\[GreaterEqual]", "0"}]}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{"v", ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"Real", " ", "&&", " ", 
       RowBox[{"t", "\[GreaterEqual]", "0"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"res", "=", 
  RowBox[{
   RowBox[{"y", "[", "t", "]"}], "/.", " ", 
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[Equal]", " ", 
         RowBox[{
          RowBox[{"y", "[", "t", "]"}], "+", " ", 
          RowBox[{"p", " ", 
           RowBox[{
            RowBox[{"y", "'"}], "[", "t", "]"}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"y", "[", "0", "]"}], "==", "0"}]}], "}"}], ",", " ", "y", 
      ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"dres", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"res", ",", " ", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ddres", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"dres", ",", " ", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"res", ",", " ", "x"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "0.2"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", "All"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dres", ",", " ", "v"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "0.2"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", "All"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ddres", ",", " ", "a"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", "0.2"}], "}"}], ",", " ", 
    RowBox[{"PlotRange", " ", "\[Rule]", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "/.", " ", 
  RowBox[{"t", "\[Rule]", "0.012164"}]}], "\[IndentingNewLine]", 
 RowBox[{"v", " ", "/.", " ", 
  RowBox[{"t", "\[Rule]", "0.012164"}]}], "\[IndentingNewLine]", 
 RowBox[{"x", " ", "/.", " ", 
  RowBox[{"t", "\[Rule]", "0.012164"}]}], "\[IndentingNewLine]", 
 RowBox[{"dres", " ", "/.", " ", 
  RowBox[{"t", "\[Rule]", "0.012164"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "-", " ", "dres"}], " ", "/.", " ", 
  RowBox[{"t", "->", "0.012164"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddres", " ", "/.", " ", 
   RowBox[{"t", "\[Rule]", "0.012164"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "/.", " ", 
   RowBox[{"t", "\[Rule]", "0.2"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[344]:=",ExpressionUUID->"d14e1cd0-39e2-4e25-9d43-cf666c5be863"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"res", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"y", "[", "t", "]"}], "/.", " ", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", " ", "t"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "a", " ", 
            RowBox[{"t", "^", "2"}]}]}], "\[Equal]", " ", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "+", " ", 
           RowBox[{"p", " ", 
            RowBox[{
             RowBox[{"y", "'"}], "[", "t", "]"}]}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"y", "[", "0", "]"}], "==", "0"}]}], "}"}], ",", " ", "y", 
       ",", " ", "t"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dres", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"res", ",", " ", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddres", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"dres", ",", " ", "t"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atime", " ", "=", " ", 
   RowBox[{"t", "/.", " ", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", ">", "0"}], ",", " ", 
         RowBox[{"0", " ", "<", " ", "p", " ", "\[LessEqual]", "1"}], ",", 
         " ", 
         RowBox[{"b", "<", "a"}], ",", " ", 
         RowBox[{"v", " ", "<", " ", 
          RowBox[{"b", " ", "p"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Simplify", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ddres", " ", "\[Equal]", " ", "b"}], ",", " ", 
            RowBox[{"t", ">", "0"}], ",", " ", 
            RowBox[{"0", " ", "<", " ", "p", " ", "\[LessEqual]", "1"}], ",", 
            " ", 
            RowBox[{"b", "<", "a"}], ",", " ", 
            RowBox[{"v", " ", "<", " ", 
             RowBox[{"b", " ", "p"}]}]}], "}"}], ",", " ", "t", ",", " ", 
          "Reals"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"p", " ", "=", " ", "0.03"}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", "3000"}], "\[IndentingNewLine]", 
 RowBox[{"b", " ", "=", " ", "1000"}], "\[IndentingNewLine]", 
 RowBox[{"v", " ", "=", " ", "0"}], "\[IndentingNewLine]", 
 RowBox[{"atime", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"res", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"y", "[", "t", "]"}], "/.", " ", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", " ", "t"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "a", " ", 
            RowBox[{"t", "^", "2"}]}]}], "\[Equal]", " ", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "+", " ", 
           RowBox[{"p", " ", 
            RowBox[{
             RowBox[{"y", "'"}], "[", "t", "]"}]}]}]}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", 
          RowBox[{"v", " ", "-", " ", 
           RowBox[{"p", " ", "b"}]}]}]}], "}"}], ",", " ", "y", ",", " ", 
       "t"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dres", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"res", ",", " ", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ddres", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"dres", ",", " ", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtime", " ", "=", " ", 
   RowBox[{"t", "/.", " ", 
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", " ", ">", "0"}], ",", " ", 
         RowBox[{"0", " ", "<", " ", "p", " ", "\[LessEqual]", "1"}], ",", 
         " ", 
         RowBox[{"a", ">", "0"}], ",", " ", 
         RowBox[{"b", " ", ">", " ", "0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Simplify", "@", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"ddres", " ", "\[Equal]", " ", "0"}], ",", " ", "t", ",", 
          " ", "Reals"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"blah", " ", "=", " ", 
  RowBox[{"dres", " ", "/.", " ", 
   RowBox[{"t", "->", "dtime"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"v", " ", "/.", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", " ", ">", "0"}], ",", " ", 
        RowBox[{"b", ">", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "@", 
       RowBox[{
        RowBox[{"Solve", "[", " ", 
         RowBox[{
          RowBox[{"blah", " ", "\[Equal]", " ", "100"}], ",", " ", "v", ",", 
          " ", "Reals"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cruisetime", " ", "=", " ", 
   RowBox[{"t", " ", "/.", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"a", " ", "atime"}], " ", "+", " ", 
         RowBox[{"b", " ", "t"}]}], " ", "\[Equal]", " ", "v"}], ",", " ", 
       "t"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"p", " ", "=", " ", "0.03"}], "\[IndentingNewLine]", 
 RowBox[{"a", " ", "=", " ", "3000"}], "\[IndentingNewLine]", 
 RowBox[{"b", " ", "=", " ", "1000"}], "\[IndentingNewLine]", 
 RowBox[{"atime", " ", "=", " ", 
  "0.012163953243244931"}], "\[IndentingNewLine]", "dtime", "\
\[IndentingNewLine]", "cruisetime"}], \
"Input",ExpressionUUID->"2c00f5bf-774b-4859-b7ff-5dd348462164"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"printSubscripts", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"fullName_", ",", " ", "var_", ",", " ", "subscript_"}], 
        "]"}], " ", ":=", "\n", "\t\t", 
       RowBox[{"fullName", " ", "\[Rule]", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Subscript", "[", 
          RowBox[{"var", ",", " ", "subscript"}], "]"}], "]"}]}]}], ";", "\n",
       "\t", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"S", ",", " ", "HoldAll"}], "]"}], ";", "\n", "\t", 
      RowBox[{"expr", " ", "/.", " ", 
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"aMax", ",", " ", "a", ",", " ", "max"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"tA", ",", " ", "t", ",", " ", "a"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"tC", ",", " ", "t", ",", " ", "c"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"tD", ",", " ", "t", ",", " ", "d"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"tTot", ",", " ", "t", ",", " ", "tot"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"vS", ",", " ", "v", ",", " ", "s"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"vC", ",", " ", "v", ",", " ", "c"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"vE", ",", " ", "v", ",", " ", "e"}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"S", "[", 
          RowBox[{"vMax", ",", " ", "v", ",", " ", "max"}], "]"}]}], "\n", 
        "\t", "}"}]}]}]}], "]"}]}], "\n", "\t"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$PrePrint", " ", "=", " ", "printSubscripts"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "a", ",", " ", "aMax", ",", " ", "v", ",", " ", "x", ",", " ", "vC", ",", 
   " ", "tA", ",", " ", "tC", ",", " ", "tD", ",", " ", "tTot", ",", " ", 
   "tC"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tTot", ",", " ", "vC"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"trapezoidial", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"a", " ", "\[Rule]", " ", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"aMax", ",", " ", 
             RowBox[{
             "0", " ", "\[LessEqual]", " ", "t", " ", "<=", " ", "tA"}]}], 
            "}"}], ",", "\n", "\t\t", 
           RowBox[{"{", 
            RowBox[{"25", ",", " ", 
             RowBox[{"tA", " ", "<", " ", "t", " ", "<=", " ", 
              RowBox[{"tA", " ", "+", " ", "tC"}]}]}], "}"}], ",", "\n", 
           "\t\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "aMax"}], ",", " ", 
             RowBox[{
              RowBox[{"tA", " ", "+", " ", "tC"}], " ", "<", " ", "t", " ", 
              "\[LessEqual]", " ", 
              RowBox[{"tA", " ", "+", " ", "tC", " ", "+", " ", "tD"}]}]}], 
            "}"}]}], "\[IndentingNewLine]", "\t", "}"}], "]"}]}], "}"}]}], 
     ";", "\n", "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"trapezoidial", ",", "\n", "\t\t", 
       RowBox[{"v", " ", "\[Rule]", " ", 
        RowBox[{"PiecewiseIntegrate", "[", 
         RowBox[{
          RowBox[{"a", " ", "/.", " ", "trapezoidial"}], ",", " ", "vS"}], 
         "]"}]}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"trapezoidial", ",", " ", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"x", " ", "\[Rule]", " ", 
        RowBox[{"PiecewiseIntegrate", "[", 
         RowBox[{"v", " ", "/.", " ", "trapezoidial"}], "]"}]}]}], "]"}], ";",
      "\n", "\n", "\t", "\n", "\t", 
     RowBox[{"vC", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"d", " ", "*", " ", "aMax"}], " ", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["vS", "2"], " ", "+", " ", 
             SuperscriptBox["vE", "2"]}], ")"}], " ", "/", " ", "2"}]}], 
         "]"}], ",", " ", "vMax"}], "]"}]}], ";", "\n", "\t\t", "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"trapezoidial", ",", "\n", "\t\t", 
       RowBox[{"tA", " ", "\[Rule]", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"PiecewiseExpand", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"vC", " ", "-", " ", "vS"}], ")"}], " ", "/", " ", 
           "aMax"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"trapezoidial", ",", "\n", "\t\t", 
       RowBox[{"tD", " ", "\[Rule]", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"PiecewiseExpand", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"vC", " ", "-", " ", "vE"}], ")"}], " ", "/", " ", 
           "aMax"}], "]"}]}]}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"tTot", " ", "=", " ", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox["d", "vMax"], " ", "+", " ", 
            RowBox[{
             FractionBox["vMax", 
              RowBox[{"2", " ", "aMax"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", " ", 
                FractionBox["vS", "vMax"]}], ")"}], "2"]}], "+", 
            RowBox[{
             FractionBox["vMax", 
              RowBox[{"2", " ", "aMax"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", " ", 
                FractionBox["vE", "vMax"]}], ")"}], "2"]}]}], ",", " ", 
           RowBox[{"vC", " ", "==", " ", "vMax"}]}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"tA", " ", "+", " ", "tD"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"trapezoidial", ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tC", " ", "\[Rule]", " ", 
           RowBox[{"PiecewiseExpand", "[", 
            RowBox[{"tTot", " ", "-", " ", "tA", " ", "-", " ", "tD"}], 
            "]"}]}], " ", "\n", "\t\t", "/.", " ", 
          RowBox[{"tA", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"tA", " ", "/.", " ", "trapezoidial"}], ")"}]}]}], "\n", 
         "\t\t", "/.", " ", 
         RowBox[{"tD", " ", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"tD", " ", "/.", " ", "trapezoidial"}], ")"}]}]}], "\n", 
        "\t\t", "//", " ", "Simplify"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n",
    "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"trapezoidial", " ", "//", " ", "TraditionalForm"}], "\n"}], "Code",
 CellLabel->
  "In[863]:=",ExpressionUUID->"bda53053-4d26-4673-98fe-608246cc28c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{
    RowBox[{"printSubscripts", "[", 
     RowBox[{
      RowBox[{"a", " ", "/.", " ", "trapezoidial"}], " ", "//", " ", 
      "Simplify"}], "]"}], " ", "//", " ", "TraditionalForm"}], "]"}], 
  "\n"}]], "Input",
 CellLabel->"In[857]:=",ExpressionUUID->"0c103c70-4bdb-414b-94ea-2f9630cbabee"]
},
WindowSize->{788, 637},
WindowMargins->{{242, Automatic}, {123, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
AutoIndent->False,
TrackCellChangeTimes->False,
LineIndent->1.,
FrontEndVersion->"11.3 for Linux ARM (32-bit) (May 23, 2018)",
StyleDefinitions->"Default.nb"
]

